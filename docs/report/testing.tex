\chapter{Viability Testing}
The following chapter presents factors we believe to be of relevance and important to test so that the viability of the system can be established. The initial section will describe what factors are to be tested, why these are being tested, and what we find acceptable parameters to be. The later section describe the tests performed in order to test each factor and the attained results. All the tests are performed using a Galaxy Nexus \cite{galaxyNexus} and a Wii Remote with a Motion Plus extension unless stated otherwise.

\section{Deciding factors}
Battery life is an important factor for the viability of the system. The majority of Android devices come with specific batteries which are easily rechargeable and have a well documented battery life. The Wii Remote on the other hand does not. If the battery life is too short it would be cumbersome to change them, increase cost and reduce the overall satisfaction with the system. We estimated that an Android device battery would last at least 24 hours and be charged while the user is asleep, hence the same logic should apply to the Wii Remote. Therefore a minimum parameter of 24 hours was set in order for the battery life to be satisfactory.

Range is something that should always be considered when dealing with wireless devices. It might be desirable for a user to not carry the smartphone around at home, or at work. Having a notion of what the range is would allows the user to comfortably walk around without having to worry about staying close to the smartphone at all times. Most manufacturers use the Bluetooth Class 2 radio which allows a minimum range of 10 meters, and thus this is what we consider to be the acceptable minimum value.

The performance of the application on the smartphone is another important factor. In order to create a mobile biofeedback system the application needs to process data from the Wii Remote in real time with as little delay as possible. We found this factor satisfactory if we noticed no hitches and there was no lag present in the 3D cube while mirroring the movements of the Wii Remote.

Finally the audio- and vibrotactile feedback were tested. The tests were of a qualitative nature in order to discover any apparent problems with the two feedback types, and the writers were the only test subjects. We did not perform any major tweaking or spend a large amount of resources finding the optimal position and threshold settings for the system.

\section{Battery life}
The Wii Remote is powered by two AA batteries and battery life is based on several factors. The official statement from Nintendo is ``up to 30 hours’’ \cite{wiiBattery}

As the prototype application does not utilize all of the features the Wii Remote offers, but only the sensor data and rumble feature we hope to have a battery life of at least 30 hours. The batteries used to perform the test were pairs of Duracell Ultra Power batteries. These were chosen because they are available at almost any convenient store. The Galaxy Nexus was connected to a charger during the entire test, while the Wii Remote had new batteries put into it before each test.

The application used was a slightly modified version of our prototype application. The changes should have no impact on the battery life of the Wii Remote as the changes only affected the Android device. Battery life was measured by a timer that started when the Wii Remote was connected,  and stopped when the connection was lost. The threshold alarm was disabled and instead a button was added, allowing manual control of the rumble pack in the Wii Remote.

Two set of tests were performed in order to measure battery life. The first set involved the Wii Remote transmitting sensor data to the Galaxy Nexus. The second test set had the Wii Remote rumbling while sensor data was being transmitted. Time and resource constraints limited what type of battery tests could be performed, so two extremes was decided as a good indicator of expected battery life. 

\begin{table}[h]
\centering
\setlength{\extrarowheight}{0,2cm}
\begin{tabular}{p{2cm}|p{4.75cm}|p{4.75cm}|}
\cline{2-3}
&\multicolumn{2}{c|}{\textbf{Time}}\\ \hline
\textbf{Test Nr.} &\textbf{No Rumble} & \textbf{Rumble} \\ \hline
1 & 63:18:04 & 33:12:44 \\ \hline
2 & 61:56:21 & 33:13:45 \\ \hline
3 & 62:23:55 & 33:10:28 \\ \hline
\end{tabular}
\caption{Results after 6 runs of the battery test}
\label{tab:batteryLife}
\end{table}

The table above (table~\ref{tab:batteryLife}) shows a similar result of 33 hours with constant rumbling and approximately 62 without rumbling. Our system will have a mix of both depending on the amount of feedback it needs to provide. The expected uptime on the battery type we tested is then somewhere between 33 - 62 hours of use. Considering constant rumbling is highly unlikely, we assume that the battery life is on higher end of the scale.

Our initial expectation was a minimum of 24 hours, the results were far beyond what we expected it to be, which speaks positively for the Wii Remote as possible sensory device. We used brand batteries that boast about longer battery life, but with such a high numbers we believe that even a non-brand and rechargeable battery will be above the 24 hour minimum limit.

\section{Range}
The connection was tested with a 30 meter distance in a open landscape computer lab and no connection issues were present. With a wall in between the Wii Remote and Android device a range of 15 meters was reached before signs of signal loss started to appear, by this we mean that the 3D object was not updating smoothly or the Wii Remote started vibrating franticly.

A distance of 30 meters in an open landscape and 15 meters with walls between, is well beyond our initial expectation of 10 meters and helps establish the Wii Remote as a viable sensory device for our system.

\section{Performance}
A performance test was done with the identical application version across three different Android devices: HTC One S running stock firmware, Galaxy Nexus running stock firmware and a HTC Desire HD running Cynaogenmod 7. The Desire HD was released in 2010 and has the weakest hardware among the test devices. The test consisted of connecting the Wii Remote, calibrating it, and then changing the orientation of the Wii Remote in several directions at increasing speed. The results are shown in the table below~\ref{tab:testResults}.

\begin{table}[h!]
\centering
\begin{tabularx}{\textwidth}{|X||c|c|c|}
\hline
\textbf{Device} & \textbf{Connecting} & \textbf{Calibrating} & \textbf{Change orientation} \\ \hline
HTC Desire HD & Pass & Pass & Pass \\ \hline
Galaxy Nexus & Pass & Pass & Pass \\ \hline
HTC One S & Pass & Pass & Pass \\ \hline

\end{tabularx}
\caption{\footnotesize Results from the testing}
\label{tab:testResults}
\end{table}

All three devices performed satisfactory with no lag present in the mirroring of the Wii Remote, though there were some minor bugs. This helps confirm that modern smartphones have the processing power required to function as a hub for processing sensor data in real-time. The fact that the application worked on an Android device with HTC Sense was a major surprise, this might mean that devices with Android version 4.0 from HTC do support L2CAP and allow the application to function properly on the system, but this has not been researched further.

As mentioned a few bugs were discovered during the testing. The implementation of alarm beeps did not sound as smooth on the Galaxy Nexus and HTC One S as it did on HTC Desire HD used during development. The frequency of beeps is much lower as well as the transition to higher frequencies of beeps being less smooth. This could probably be fixed by changing the way the alarm sound is implemented, but since this application is a proof of concept prototype, improving this functionality was not prioritized. In addition the 3D-cube sometimes renders incorrectly in small intervals on the Galaxy Nexus. The cube is there  for debugging purposes, therefore time was not dedicated to fixing the issue.

\section{Vibrotactile feedback}
A problem we discovered was that the Wii Remote vibration was not strong enough for the user to notice it. During the low frequency pulsing vibrations it was nearly impossible to notice the vibrations unless the user knew it was about to happen. At higher frequency it was slightly better, but still not satisfactory. The Wii Remote was facing with the button surface away from the body, and the batteries inside the Wii Remote are quite large and heavy. We noticed that the batteries were absorbing most of the vibration , meaning that the area around the batteries was barely vibrating. Turning the Wii Remote so that the surface containing buttons was facing towards the body gave slightly better results. We attempted to remove the strap and hold the Wii Remote manually against the skin. This did improve the results further, but is not a feasible approach.
