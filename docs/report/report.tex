\documentclass[11pt,twoside,a4paper]{report}
\usepackage[utf8]{inputenc}


\begin{document}
%Top matter begin
\title{Falldetection}
\author{Knut Esten Melandsø Nekså and Dean Lozo}
\date{\today}
\maketitle

% Top matter end

\begin{abstract}

\end{abstract}

\tableofcontents

\chapter{Introduction}
%The Introduction is your thesis in a nutshell. Again, the organization can vary, but a standard introduction includes the following sections:

\section{Purpose}
The purpose of the project is to explore the possibilities of creating bio-feedback systems through the use of a smartphone and COTS products, mainly game controllers. The purpose of the bio-feedback system will be to improve the stability and balance of the user through peripherals connected to the phone.

\section{Motivation}
%Brief description of the research domain and the problem that one wants to address. It should tell the reader why working on this project is worth doing.
Falls are a major health hazard among the elderly population (age > 65) \cite{falls health hazard}, in addition to being an obstacle for physical activity and independent living. Through physical activity the elderly may improve their quality of life and prevent future disabilities\cite{physical activity}. A third of all elders that experience a fall develop a fear of falling \cite{fear of falling}. Fear of falling causes general anxiety and avoidance of physical activity. Long term consequences result in social isolation, physical deterioration and reduced quality of life.\cite{physical avoidance} %Skrive noe om hvor mye det koster staten å passe på de eldre?

Between 30\% and 60\% of the elder population will experience at least one fall per year, and 10\% - 20\% of these will result in an injury, hospitalization or death \cite{fall statistics}. 



\section{Research goals}
%What are the questions you are answering with your project? Normally, you specify a main question and related sub-questions. Remember that at the end you have to demonstrate you have answered to the stated questions. It is not uncommon that the questions are changed during the project, but it is important to be as explicit as possible and as early as possible with research questions since they help you to focus.

\section{Research method}
%How the research is conducted. In the previous section you say what you are doing. Here you specify how. The choice of a research method is strictly connected to the type of questions you want to answer.

\section{Results}
%a brief description of the results that you are delivering.


\chapter{State of the Art}
%This chapter provides an overview of the literature. It positions your work with respect to work already done by others. 

\section{PS3 Move}
%DETTE KAN IKKE FJERNES FØR BÅDE KNUT OG DEAN HAR GÅTT GJENNOM DENNE SEKSJONEN OG REFERANSER HAR BLITT LAGT TIL!

\subsection{Motion Controller Hardware}
The PS Move motion controller contains advanced motion sensing, making it an ideal peripheral for a bio-feedback system. It features motion tracking through a three axis accelerometer, a three axis angular rate sensor and provides location tracking through the built in magnetometer. The built in vibration could be used to provide feedback to the user. %CITATION NEEDED


\subsection{PS Move API}

The PS Move API is written in C, but contains bindings for various languages, including Java and C\# which are both languages used in smartphone application development. The API explicitly mentions that it runs on Android devices. This is a truth with modifications. It will not run out of the box on an Android device, in addition restructuring and heavy modification of the Android device is required.  The Android OS runs on top of a modified Linux kernel, this kernel does not contain the necessary libraries and drivers in order for the API and Motion controller connectivity to function properly. %Does this need citation?
The next step would be to compile the C API into a shared library using the Android NDK, and use the shared library Java bindings in the Android Java code.

Everything is possible with enough time, but given the time constraint and amount of time required to get this running it was decided that this was not a path worth pursuing for this project. With some much work required it would be simpler to run Ubuntu off an Android device if this becomes available in the future. %ref til ubuntu android sider.

\section{Wii Remote with Motion Plus}

\subsection{Wii Remote and Motion Plus Hardware}
The original Wii Remote features motion tracking for vertical movement, left-right horizontal movement, and horizontal rotation. %CITATION
In June 2009 %CITATION NEEDED
Nintendo released the Wii MotionPlus expansion device which contains a dual-axis tuning fork and a single-axis gyroscope. %CITATION NEEDED
The expansion device improves the motion tracking of the Wii Remote greatly, but makes it larger. Nintendo has now started selling the Wii Remote Plus. It is the same size as the Wii Remote, but has the Wii MotionPlus already built in. Both of the controller types have the ability to provide vibration and basic audio feedback.

\subsection{Wii Remote API}
%Skrive om at det er veldig utbredt men ting stoppet 2009, det er veldig mange av dem men ingen er til Android men mange er skrevet i java osv. Hvilken utfordinger kan vi se. IKKE SKRIV OM CASET I DETTE AVSNITET. Altså ikke skriv om hva vi faktisk har gjort for å få det til å funke, men heller hva vi allerede så vil være problemet. Dette med bluetooth, ikke wiimote plus support osv.


Currently no Wii remote library has been created for Android. Though there are plenty of Wii remote libraries out there, this report will only cover the most developed projects written in Java.

WiiRemoteJ is one of the most complete libraries for the Wii remote. It is a pure Java library with support of all major features of the Wii remote, it does however lack support for the MotionPlus extension. The project has been discontinued for over a year now. 

WiiUseJ is a lightweight Java API. It was built on top of the Wiiuse API and supports most of the major features of the Wii remote, though it lacks support for the MotionPlus extension. The project has been discontinued since 2009.

Motej is an open source (licensed under ASL 2.0) library for the Wii remote written in Java. Motej supports of the major Wii remote extensions, but not the MotionPlus extension. The project is currently at version 0.9 and has been discontinued since 2009.

%Development
Since no library with Android support currently exist it was decided to use the Motej library as a core for further development.

The Motej uses the BlueCove libarary as an multi-platform interface to the Bluetooth stack. Unfortunately, BlueCove does not support the Android OS. Android comes with its own Bluetooth API, the Android Bluetooth API. This library supports most Bluetooth devices through the RFCOMM Bluetooth protocol, however it does not currently support the L2CAP Bluetooth protocol which is used by the Wii remote. Though the Android SDK does not include any support for the L2CAP Bluetooth protocol, communication is possible through the native development kit (NDK). %THIS NEEDS MORE WORK, WORK DEAN WOOOOOORK!

Motej does not support the MotionPlus extension and this support has to be added. Fortunately there are open source C++, C\# libraries with support for the MotionPlus extension, so this functionality was not hard to add.

\subsection{Bluetooth}
%General information about bluetooth, and some text about L2CAP and why Android sucks.
Bluetooth is a widely used wireless communication technology for shorter distances. Due to its low power consumption and low cost is has become one of the leading standards in its field and is supported by most modern operating systems, either through integrated hardware or through portable Bluetooth adapter. Most, if not all, modern phones come with a built-in Bluetooth card/radio. 

The Wii Remote uses Bluetooth to communicate wirelessly with other devices, using the logical link control and adaptation protocol (L2CAP). Though all Android have built-in Bluetooth cards, the current Android SDK does not offer low level support for the Bluetooth stack, including L2CAP. This constraint can be bypassed on some devices by using reflection to access the socket constructor. 

\end{document}





